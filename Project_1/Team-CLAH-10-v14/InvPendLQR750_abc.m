close all;% Set up a simple Q - identity. We will expore how solutions vary by% changing R. % Try different Qs. A = [0    1.0000         0         0;...         0   -7.4631   -3.6744         0;...         0         0         0    1.0000;...         0    9.2203   36.5168         0];B =[0;5.5966;0;-6.9143];%Use the following form for no control damping at the pendulum% Cstr=[1 0 1 0 ]% % Q=Cstr'*Cstr;%q1 = 1/(0.013*(pi/8)^2);             %table positionq2 = 1/(0.16*(pi/4)^2);               %table velocityq3 = 1/(0.022*(pi/8)^2);             %pendulum positionq4 = 1/(0.32*(pi/4)^2);              %pendulum velocityQ = [q1 0 0 0; 0 q2 0 0; 0 0 q3 0; 0 0 0 q4]% Let the output be theta_2 - the puendulum angle. CC = [0, 0, 1, 0]R = [200]%, 100, 10];%, 1, 0.1, 0.01]%for i = 1:length(R)    % Find K for supplied R.     Klqr=lqr(A,B,Q, R(i))    % where are the eigenvalues - express them in Hertz and print to screen    Pcl=eig(A-B*Klqr)/2/pi     %Create closed loop system for computed K.     syslqrcl=ss([A-B*Klqr],B*Klqr(:,1),CC,0);        % plot zero map    figure (1);     pzmap(syslqrcl);     title('LQR Controller, Closed Loop Poles For Various Control Effort Weights')    xlabel('Real  (Hz)')    ylabel('Imaginary  (Hz)')    grid;     hold on          figure(2);     %Generate step responses at theta2    t=0:.01:5;    stepr=step([A-B*Klqr],B*Klqr,CC,[0 0],1,t);    %Step Response Plot    plot(t,stepr),grid,axis([0,5,-.1, .1]),    grid    xlabel('Time (s)'),ylabel('Amplitude')    hold on;    pause%endq1 = 1/(0.04*(pi/4)^2);             %table positionq2 = 1/(0.5*(pi/3)^2);              %table velocityq3 = 1/(0.04*(pi/4)^2);             %pendulum positionq4 = 1/(0.5*(pi/3)^2);              %pendulum velocityQ = [q1 0 0 0; 0 q2 0 0; 0 0 q3 0; 0 0 0 q4];% Let the output be theta_2 - the puendulum angle. CC = [0, 0, 1, 0]R = [8]%, 100, 10];%, 1, 0.1, 0.01]%for i = 1:length(R)    % Find K for supplied R.     Klqr=lqr(A,B,Q, R(i))    % where are the eigenvalues - express them in Hertz and print to screen    Pcl=eig(A-B*Klqr)/2/pi     %Create closed loop system for computed K.     syslqrcl=ss([A-B*Klqr],B*Klqr(:,1),CC,0);        % plot zero map    figure (1);     pzmap(syslqrcl);     title('LQR Controller, Closed Loop Poles For Various Control Effort Weights')    xlabel('Real  (Hz)')    ylabel('Imaginary  (Hz)')    grid;     hold on          figure(2);     %Generate step responses at theta2    t=0:.01:5;    stepr=step([A-B*Klqr],B*Klqr,CC,[0 0],1,t);    %Step Response Plot    plot(t,stepr),grid,axis([0,5,-.1, .1]),    grid    xlabel('Time (s)'),ylabel('Amplitude')    hold on;    pause 